#include <REGX51.H>

		ORG 0000H
		AJMP START
		ORG 0030H
START:	
		MOV TL1,#0FFH
		MOV TH1,#0FFH
		MOV TMOD,#10H
		SETB TR1
AGAIN:	MOV P3,#00H
	MOV P3,#0FFH
			
			MOV P1,#0FFH			/* P1 CHECK..*/
		  			   /* */
			MOV	A,P1
			CJNE A,#0FEH,CHEK	
			AJMP LW
	CHEK:	CJNE A,#0FDH,LAST
		AJMP HW
	LAST:	ACALL DELAYN
			AJMP NEXT
	LW:		ACALL DELAYL
			AJMP NEXT
	HW:     ACALL DELAYH

			

	NEXT:	CLR A
		MOV P3,#00H
		MOV P3,#00H
		MOV P1,#0FFH			 /* P1 CHECK*/

		MOV	A,P1
	CJNE A,#0FEH,CHEK1	
		AJMP LW
	CHEK1:	CJNE A,#0FDH,LAST1
		AJMP HW
	LAST1:	ACALL DELAYN
			AJMP NEXT
	LW1:	ACALL DELAYL
			AJMP NEXT1
	HW1:	ACALL DELAYH
			CLR A
NEXT1:	LJMP AGAIN


DELAYL:	CLR A
		JNB TF1,DELAYL
		INC A
		CLR TF1	
		CJNE A,#22H,DELAYL
		CLR A
		CLR TF1
		SETB TR1
		RET
		
DELAYH:	CLR A
		JNB TF1,DELAYH
		INC A
		CLR TF1	
		CJNE A,#32H,DELAYH
		CLR A
		CLR TF1
		SETB TR1
		RET
		
DELAYN:	CLR A
		JNB TF1,DELAYN
		INC A
		CLR TF1	
		CJNE A,#24H,DELAYN
		CLR A
		CLR TF1
		SETB TR1
		RET

		END